
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.basedpyright.com/dev/usage/type-concepts-advanced/">
      
      
        <link rel="prev" href="../mypy-comparison/">
      
      
        <link rel="next" href="../type-inference/">
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Type concepts advanced - basedpyright</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#static-typing-advanced-topics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="basedpyright" class="md-header__button md-logo" aria-label="basedpyright" data-md-component="logo">
      
  <img src="../../img/logo_black.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            basedpyright
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Type concepts advanced
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="amber"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/detachhead/basedpyright" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    detachhead/basedpyright
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="basedpyright" class="md-nav__button md-logo" aria-label="basedpyright" data-md-component="logo">
      
  <img src="../../img/logo_black.png" alt="logo">

    </a>
    basedpyright
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/detachhead/basedpyright" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    detachhead/basedpyright
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Benefits over pyright
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Benefits over pyright
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benefits-over-pyright/baseline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    baseline (beta)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benefits-over-pyright/better-defaults/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    better defaults
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benefits-over-pyright/errors-on-invalid-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    errors on invalid configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benefits-over-pyright/fixes-for-rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fixes for the reportRedeclaration and reportDuplicateImport rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benefits-over-pyright/improved-ci-integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    improved integration with CI platforms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benefits-over-pyright/improved-translations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    improved translations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benefits-over-pyright/new-diagnostic-rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    new diagnostic rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benefits-over-pyright/pylance-features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pylance features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benefits-over-pyright/pypi-package-vscode-pinning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pypi package and version pinning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/command-line-and-language-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command-line &amp; language server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/ides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IDEs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/pre-commit%20hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pre-commit hook
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/command-line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command line
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/comments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/config-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/language-server-settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Language Server Settings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/type-concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type concepts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../builtins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Builtins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Language Server Commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-resolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import resolution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-statements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import statements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mypy-comparison/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mypy comparison
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Type concepts advanced
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Type concepts advanced
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#static-typing-advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Static Typing: Advanced Topics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Typing: Advanced Topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-narrowing" class="md-nav__link">
    <span class="md-ellipsis">
      Type Narrowing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-guards" class="md-nav__link">
    <span class="md-ellipsis">
      Type Guards
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aliased-conditional-expression" class="md-nav__link">
    <span class="md-ellipsis">
      Aliased Conditional Expression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowing-for-implied-else" class="md-nav__link">
    <span class="md-ellipsis">
      Narrowing for Implied Else
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowing-any" class="md-nav__link">
    <span class="md-ellipsis">
      Narrowing Any
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowing-for-captured-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Narrowing for Captured Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#value-constrained-type-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Value-Constrained Type Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditional-types-and-type-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Conditional Types and Type Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inferred-type-of-self-and-cls-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Inferred Type of “self” and “cls” Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overloads" class="md-nav__link">
    <span class="md-ellipsis">
      Overloads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-and-instance-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Class and Instance Variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class and Instance Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pure-class-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Pure Class Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regular-class-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Regular Class Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pure-instance-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Pure Instance Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inheritance-of-class-and-instance-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritance of Class and Instance Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-variable-scoping" class="md-nav__link">
    <span class="md-ellipsis">
      Type Variable Scoping
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-annotation-comments" class="md-nav__link">
    <span class="md-ellipsis">
      Type Annotation Comments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#literal-math-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Literal Math Inference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-conditional-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Static Conditional Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reachability" class="md-nav__link">
    <span class="md-ellipsis">
      Reachability
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../type-inference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type inference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../type-stubs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type stubs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../typed-libraries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Typed libraries
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/internals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/localization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Localization notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/upstream/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    how we keep up-to-date with upstream
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../shoutouts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shoutouts
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#static-typing-advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Static Typing: Advanced Topics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Typing: Advanced Topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-narrowing" class="md-nav__link">
    <span class="md-ellipsis">
      Type Narrowing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-guards" class="md-nav__link">
    <span class="md-ellipsis">
      Type Guards
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aliased-conditional-expression" class="md-nav__link">
    <span class="md-ellipsis">
      Aliased Conditional Expression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowing-for-implied-else" class="md-nav__link">
    <span class="md-ellipsis">
      Narrowing for Implied Else
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowing-any" class="md-nav__link">
    <span class="md-ellipsis">
      Narrowing Any
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowing-for-captured-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Narrowing for Captured Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#value-constrained-type-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Value-Constrained Type Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditional-types-and-type-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Conditional Types and Type Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inferred-type-of-self-and-cls-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Inferred Type of “self” and “cls” Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overloads" class="md-nav__link">
    <span class="md-ellipsis">
      Overloads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-and-instance-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Class and Instance Variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class and Instance Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pure-class-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Pure Class Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regular-class-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Regular Class Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pure-instance-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Pure Instance Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inheritance-of-class-and-instance-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritance of Class and Instance Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-variable-scoping" class="md-nav__link">
    <span class="md-ellipsis">
      Type Variable Scoping
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-annotation-comments" class="md-nav__link">
    <span class="md-ellipsis">
      Type Annotation Comments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#literal-math-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Literal Math Inference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-conditional-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Static Conditional Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reachability" class="md-nav__link">
    <span class="md-ellipsis">
      Reachability
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Type concepts advanced</h1>

<h2 id="static-typing-advanced-topics">Static Typing: Advanced Topics</h2>
<h3 id="type-narrowing">Type Narrowing</h3>
<p>Pyright uses a technique called “type narrowing” to track the type of an expression based on code flow. Consider the following code:</p>
<div class="highlight"><pre><span></span><code><span class="n">val_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hi&quot;</span>
<span class="n">val_int</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># int | str | complex</span>

    <span class="n">val</span> <span class="o">=</span> <span class="n">val_int</span> <span class="c1"># Type is narrowed to int</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># int</span>

    <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">val_str</span> <span class="c1"># Type is narrowed to str</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># str</span>

    <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># int | str</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># int</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># str</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</code></pre></div>
<p>At the start of this function, the type checker knows nothing about <code>val</code> other than that its declared type is <code>float | str | complex</code>. Then it is assigned a value that has a known type of <code>int</code>. This is a legal assignment because <code>int</code> is considered a subclass of <code>float</code>. At the point in the code immediately after the assignment, the type checker knows that the type of <code>val</code> is an <code>int</code>. This is a “narrower” (more specific) type than <code>float | str | complex</code>. Type narrowing is applied whenever a symbol is assigned a new value.</p>
<p>Another assignment occurs several lines further down, this time within a conditional block. The symbol <code>val</code> is assigned a value known to be of type <code>str</code>, so the narrowed type of <code>val</code> is now <code>str</code>. Once the code flow of the conditional block merges with the main body of the function, the narrowed type of <code>val</code> becomes <code>int | str</code> because the type checker cannot statically predict whether the conditional block will be executed at runtime.</p>
<p>Another way that types can be narrowed is through the use of conditional code flow statements like <code>if</code>, <code>while</code>, and <code>assert</code>. Type narrowing applies to the block of code that is “guarded” by that condition, so type narrowing in this context is sometimes referred to as a “type guard”. For example, if you see the conditional statement <code>if x is None:</code>, the code within that <code>if</code> statement can assume that <code>x</code> contains <code>None</code>. Within the code sample above, we see an example of a type guard involving a call to <code>isinstance</code>. The type checker knows that <code>isinstance(val, int)</code> will return True only in the case where <code>val</code> contains a value of type <code>int</code>, not type <code>str</code>. So the code within the <code>if</code> block can assume that <code>val</code> contains a value of type <code>int</code>, and the code within the <code>else</code> block can assume that <code>val</code> contains a value of type <code>str</code>. This demonstrates how a type (in this case <code>int | str</code>) can be narrowed in both a positive (<code>if</code>) and negative (<code>else</code>) test.</p>
<p>The following expression forms support type narrowing:</p>
<ul>
<li><code>&lt;ident&gt;</code> (where <code>&lt;ident&gt;</code> is an identifier)</li>
<li><code>&lt;expr&gt;.&lt;member&gt;</code> (member access expression where <code>&lt;expr&gt;</code> is a supported expression form)</li>
<li><code>&lt;expr&gt;[&lt;int&gt;]</code> (subscript expression where <code>&lt;int&gt;</code> is a non-negative integer)</li>
<li><code>&lt;expr&gt;[&lt;str&gt;]</code> (subscript expression where <code>&lt;str&gt;</code> is a string literal)</li>
</ul>
<p>Examples of expressions that support type narrowing:</p>
<ul>
<li><code>my_var</code></li>
<li><code>employee.name</code></li>
<li><code>a.foo.next</code></li>
<li><code>args[3]</code></li>
<li><code>kwargs["bar"]</code></li>
<li><code>a.b.c[3]["x"].d</code></li>
</ul>
<h3 id="type-guards">Type Guards</h3>
<p>In addition to assignment-based type narrowing, Pyright supports the following type guards.</p>
<ul>
<li><code>x is None</code> and <code>x is not None</code></li>
<li><code>x == None</code> and <code>x != None</code></li>
<li><code>x is ...</code> and <code>x is not ...</code> (where <code>...</code> is an ellipsis token)</li>
<li><code>x == ...</code> and <code>x != ...</code> (where <code>...</code> is an ellipsis token)</li>
<li><code>type(x) is T</code> and <code>type(x) is not T</code></li>
<li><code>type(x) == T</code> and <code>type(x) != T</code></li>
<li><code>x is E</code> and <code>x is not E</code> (where E is a literal enum or bool)</li>
<li><code>x is C</code> and <code>x is not C</code> (where C is a class)</li>
<li><code>x == L</code> and <code>x != L</code> (where L is an expression that evaluates to a literal type)</li>
<li><code>x.y is None</code> and <code>x.y is not None</code> (where x is a type that is distinguished by a field with a None)</li>
<li><code>x.y is E</code> and <code>x.y is not E</code> (where E is a literal enum or bool and x is a type that is distinguished by a field with a literal type)</li>
<li><code>x.y == LN</code> and <code>x.y != LN</code> (where LN is a literal expression or <code>None</code> and x is a type that is distinguished by a field or property with a literal type)</li>
<li><code>x[K] == V</code>, <code>x[K] != V</code>, <code>x[K] is V</code>, and <code>x[K] is not V</code> (where K and V are literal expressions and x is a type that is distinguished by a TypedDict field with a literal type)</li>
<li><code>x[I] == V</code> and <code>x[I] != V</code> (where I and V are literal expressions and x is a known-length tuple that is distinguished by the index indicated by I)</li>
<li><code>x[I] is B</code> and <code>x[I] is not B</code> (where I is a literal expression, B is a <code>bool</code> or enum literal, and x is a known-length tuple that is distinguished by the index indicated by I)</li>
<li><code>x[I] is None</code> and <code>x[I] is not None</code> (where I is a literal expression and x is a known-length tuple that is distinguished by the index indicated by I)</li>
<li><code>len(x) == L</code>, <code>len(x) != L</code>, <code>len(x) &lt; L</code>, etc. (where x is tuple and L is an expression that evaluates to an int literal type)</li>
<li><code>x in y</code> or <code>x not in y</code> (where y is instance of list, set, frozenset, deque, tuple, dict, defaultdict, or OrderedDict)</li>
<li><code>S in D</code> and <code>S not in D</code> (where S is a string literal and D is a TypedDict)</li>
<li><code>isinstance(x, T)</code> (where T is a type or a tuple of types)</li>
<li><code>issubclass(x, T)</code> (where T is a type or a tuple of types)</li>
<li><code>f(x)</code> (where f is a user-defined type guard as defined in <a href="https://www.python.org/dev/peps/pep-0647/">PEP 647</a> or <a href="https://www.python.org/dev/peps/pep-0742">PEP 742</a>)</li>
<li><code>bool(x)</code> (where x is any expression that is statically verifiable to be truthy or falsey in all cases)</li>
<li><code>x</code> (where x is any expression that is statically verifiable to be truthy or falsey in all cases)</li>
</ul>
<p>Expressions supported for type guards include simple names, member access chains (e.g. <code>a.b.c.d</code>), the unary <code>not</code> operator, the binary <code>and</code> and <code>or</code> operators, subscripts that are integer literals (e.g. <code>a[2]</code> or <code>a[-1]</code>), and call expressions. Other operators (such as arithmetic operators or other subscripts) are not supported.</p>
<p>Some type guards are able to narrow in both the positive and negative cases. Positive cases are used in <code>if</code> statements, and negative cases are used in <code>else</code> statements. (Positive and negative cases are flipped if the type guard expression is preceded by a <code>not</code> operator.) In some cases, the type can be narrowed only in the positive or negative case but not both. Consider the following examples:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span> <span class="k">pass</span>
<span class="k">class</span> <span class="nc">Bar</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Foo</span> <span class="o">|</span> <span class="n">Bar</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Bar</span><span class="p">):</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Bar</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Foo</span>

<span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># float</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># float | None</span>
</code></pre></div>
<p>In the example of <code>func1</code>, the type was narrowed in both the positive and negative cases. In the example of <code>func2</code>, the type was narrowed only the positive case because the type of <code>val</code> might be either <code>float</code> (specifically, a value of 0.0) or <code>None</code> in the negative case.</p>
<h3 id="aliased-conditional-expression">Aliased Conditional Expression</h3>
<p>Pyright also supports a type guard expression <code>c</code>, where <code>c</code> is an identifier that refers to a local variable that is assigned one of the above supported type guard expression forms. These are called “aliased conditional expressions”. Examples include <code>c = a is not None</code> and <code>c = isinstance(a, str)</code>. When “c” is used within a conditional check, it can be used to narrow the type of expression <code>a</code>.</p>
<p>This pattern is supported only in cases where <code>c</code> is a local variable within a module or function scope and is assigned a value only once. It is also limited to cases where expression <code>a</code> is a simple identifier (as opposed to a member access expression or subscript expression), is local to the function or module scope, and is assigned only once within the scope. Unary <code>not</code> operators are allowed for expression <code>a</code>, but binary <code>and</code> and <code>or</code> are not.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">is_str</span> <span class="o">=</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">is_str</span><span class="p">:</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># str</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># None</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">):</span>
    <span class="n">is_str</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_str</span><span class="p">:</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># bytes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c1"># str</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">func3</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">is_str</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">is_str</span><span class="p">:</span>
        <span class="c1"># This technique doesn&#39;t work for subscript expressions,</span>
        <span class="c1"># so x[0] is not narrowed in this case.</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># str | None</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">func4</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">is_str</span> <span class="o">=</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">is_str</span><span class="p">:</span>
        <span class="c1"># This technique doesn&#39;t work in cases where the target</span>
        <span class="c1"># expression is assigned elsewhere. Here `x` is assigned</span>
        <span class="c1"># elsewhere in the function, so its type is not narrowed</span>
        <span class="c1"># in this case.</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># str | None</span>

    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</code></pre></div>
<h3 id="narrowing-for-implied-else">Narrowing for Implied Else</h3>
<p>When an “if” or “elif” clause is used without a corresponding “else”, Pyright will generally assume that the code can “fall through” without executing the “if” or “elif” block. However, there are cases where the analyzer can determine that a fall-through is not possible because the “if” or “elif” is guaranteed to be executed based on type analysis.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="c1"># Error: &quot;y&quot; is possibly unbound</span>

<span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="c1"># No error</span>
</code></pre></div>
<p>This can be especially useful when exhausting all members in an enum or types in a union.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="k">class</span> <span class="nc">Color</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">RED</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">BLUE</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">GREEN</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">def</span> <span class="nf">func3</span><span class="p">(</span><span class="n">color</span><span class="p">:</span> <span class="n">Color</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">color</span> <span class="o">==</span> <span class="n">Color</span><span class="o">.</span><span class="n">RED</span> <span class="ow">or</span> <span class="n">color</span> <span class="o">==</span> <span class="n">Color</span><span class="o">.</span><span class="n">BLUE</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;yes&quot;</span>
    <span class="k">elif</span> <span class="n">color</span> <span class="o">==</span> <span class="n">Color</span><span class="o">.</span><span class="n">GREEN</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;no&quot;</span>

<span class="k">def</span> <span class="nf">func4</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;received a str&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;received an int&quot;</span>
</code></pre></div>
<p>If you later added another color to the <code>Color</code> enumeration above (e.g. <code>YELLOW = 4</code>), Pyright would detect that <code>func3</code> no longer exhausts all members of the enumeration and possibly returns <code>None</code>, which violates the declared return type. Likewise, if you modify the type of the <code>value</code> parameter in <code>func4</code> to expand the union, a similar error will be produced.</p>
<p>This “narrowing for implied else” technique works for all narrowing expressions listed above with the exception of simple falsey/truthy statements and type guards. It is also limited to simple names and doesn’t work with member access or index expressions, and it requires that the name has a declared type (an explicit type annotation). These limitations are imposed because this functionality would otherwise have significant impact on analysis performance.</p>
<h3 id="narrowing-any">Narrowing Any</h3>
<p>In general, the type <code>Any</code> is not narrowed. The only exceptions to this rule are the built-in <code>isinstance</code> and <code>issubclass</code> type guards, class pattern matching in “match” statements, and user-defined type guards. In all other cases, <code>Any</code> is left as is, even for assignments.</p>
<div class="highlight"><pre><span></span><code><span class="n">a</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">reveal_type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># Any</span>

<span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;hi&quot;</span>
<span class="n">reveal_type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># Any</span>
</code></pre></div>
<p>The same applies to <code>Any</code> when it is used as a type argument.</p>
<div class="highlight"><pre><span></span><code><span class="n">b</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">reveal_type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="c1"># list[Any]</span>

<span class="n">c</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
<span class="n">reveal_type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="c1"># list[Any]</span>
</code></pre></div>
<h3 id="narrowing-for-captured-variables">Narrowing for Captured Variables</h3>
<p>If a variable’s type is narrowed in an outer scope and the variable is subsequently captured by an inner-scoped function or lambda, Pyright retains the narrowed type if it can determine that the value of the captured variable is not modified on any code path after the inner-scope function or lambda is defined and is not modified in another scope via a <code>nonlocal</code> or <code>global</code> binding.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">inner_1</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>  <span class="c1"># int</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">val</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">inner_2</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">reveal_type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># int</span>

        <span class="n">inner_1</span><span class="p">()</span>
        <span class="n">inner_2</span><span class="p">()</span>
</code></pre></div>
<h3 id="value-constrained-type-variables">Value-Constrained Type Variables</h3>
<p>When a TypeVar is defined, it can be constrained to two or more types (values).</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Example of unconstrained type variable</span>
<span class="n">_T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>

<span class="c1"># Example of value-constrained type variables</span>
<span class="n">_StrOrFloat</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_StrOrFloat&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
</code></pre></div>
<p>When a value-constrained TypeVar appears more than once within a function signature, the type provided for all instances of the TypeVar must be consistent.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">_StrOrFloat</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">_StrOrFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_StrOrFloat</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1"># The arguments for `a` and `b` are both `str`</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="s2">&quot;hi&quot;</span><span class="p">,</span> <span class="s2">&quot;there&quot;</span><span class="p">)</span>
<span class="n">reveal_type</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="c1"># str</span>

<span class="c1"># The arguments for `a` and `b` are both `float`</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">)</span>
<span class="n">reveal_type</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="c1"># float</span>

<span class="c1"># The arguments for `a` and `b` are inconsistent types</span>
<span class="n">v3</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="s2">&quot;hi&quot;</span><span class="p">)</span> <span class="c1"># Error</span>
</code></pre></div>
<h3 id="conditional-types-and-type-variables">Conditional Types and Type Variables</h3>
<p>When checking the implementation of a function that uses type variables in its signature, the type checker must verify that type consistency is guaranteed. Consider the following example, where the input parameter and return type are both annotated with a type variable. The type checker must verify that if a caller passes an argument of type <code>str</code>, then all code paths must return a <code>str</code>. Likewise, if a caller passes an argument of type <code>float</code>, all code paths must return a <code>float</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_one</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">_StrOrFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_StrOrFloat</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="s2">&quot;1&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">reveal_type</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>  <span class="c1"># str* | float*</span>
    <span class="k">return</span> <span class="nb">sum</span>
</code></pre></div>
<p>The type of variable <code>sum</code> is reported with a star (<code>*</code>). This indicates that internally the type checker is tracking the type as a “conditional” type. In this particular example, it indicates that <code>sum</code> is a <code>str</code> type if the parameter <code>value</code> is a <code>str</code> but is a <code>float</code> if <code>value</code> is a <code>float</code>. By tracking these conditional types, the type checker can verify that the return type is consistent with the return type <code>_StrOrFloat</code>. Conditional types are a form of <em>intersection</em> type, and they are considered subtypes of both the concrete type and the type variable.</p>
<h3 id="inferred-type-of-self-and-cls-parameters">Inferred Type of “self” and “cls” Parameters</h3>
<p>When a type annotation for a method’s <code>self</code> or <code>cls</code> parameter is omitted, pyright will infer its type based on the class that contains the method. The inferred type is internally represented as a type variable that is bound to the class.</p>
<p>The type of <code>self</code> is represented as <code>Self@ClassName</code> where <code>ClassName</code> is the class that contains the method. Likewise, the <code>cls</code> parameter in a class method will have the type <code>Type[Self@ClassName]</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Parent</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">method1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Self@Parent</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">method2</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">reveal_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>  <span class="c1"># Type[Self@Parent]</span>
        <span class="k">return</span> <span class="bp">cls</span>

<span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Parent</span><span class="p">):</span>
     <span class="o">...</span>

<span class="n">reveal_type</span><span class="p">(</span><span class="n">Child</span><span class="p">()</span><span class="o">.</span><span class="n">method1</span><span class="p">())</span>  <span class="c1"># Child</span>
<span class="n">reveal_type</span><span class="p">(</span><span class="n">Child</span><span class="o">.</span><span class="n">method2</span><span class="p">())</span>  <span class="c1"># Type[Child]</span>
</code></pre></div>
<h3 id="overloads">Overloads</h3>
<p>Some functions or methods can return one of several different types. In cases where the return type depends on the types of the input arguments, it is useful to specify this using a series of <code>@overload</code> signatures. When Pyright evaluates a call expression, it determines which overload signature best matches the supplied arguments.</p>
<p><a href="https://www.python.org/dev/peps/pep-0484/#function-method-overloading">PEP 484</a> introduced the <code>@overload</code> decorator and described how it can be used, but the PEP did not specify precisely how a type checker should choose the “best” overload. Pyright uses the following rules.</p>
<ol>
<li>
<p>Pyright first filters the list of overloads based on simple “arity” (number of arguments) and keyword argument matching. For example, if one overload requires two positional arguments but only one positional argument is supplied by the caller, that overload is eliminated from consideration. Likewise, if the call includes a keyword argument but no corresponding parameter is included in the overload, it is eliminated from consideration.</p>
</li>
<li>
<p>Pyright next considers the types of the arguments and compares them to the declared types of the corresponding parameters. If the types do not match for a given overload, that overload is eliminated from consideration. Bidirectional type inference is used to determine the types of the argument expressions.</p>
</li>
<li>
<p>If only one overload remains, it is the “winner”.</p>
</li>
<li>
<p>If more than one overload remains, the “winner” is chosen based on the order in which the overloads are declared. In general, the first remaining overload is the “winner”. There are two exceptions to this rule.
    Exception 1: When an <code>*args</code> (unpacked) argument matches a <code>*args</code> parameter in one of the overload signatures, this overrides the normal order-based rule.
    Exception 2: When two or more overloads match because an argument evaluates to <code>Any</code> or <code>Unknown</code>, the matching overload is ambiguous. In this case, pyright examines the return types of the remaining overloads and eliminates types that are duplicates or are subsumed by (i.e. proper subtypes of) other types in the list. If only one type remains after this coalescing step, that type is used. If more than one type remains after this coalescing step, the type of the call expression evaluates to <code>Unknown</code>. For example, if two overloads are matched due to an argument that evaluates to <code>Any</code>, and those two overloads have return types of <code>str</code> and <code>LiteralString</code>, pyright will coalesce this to just <code>str</code> because <code>LiteralString</code> is a proper subtype of <code>str</code>. If the two overloads have return types of <code>str</code> and <code>bytes</code>, the call expression will evaluate to <code>Unknown</code> because <code>str</code> and <code>bytes</code> have no overlap.</p>
</li>
<li>
<p>If no overloads remain, Pyright considers whether any of the arguments are union types. If so, these union types are expanded into their constituent subtypes, and the entire process of overload matching is repeated with the expanded argument types. If two or more overloads match, the union of their respective return types form the final return type for the call expression. This "union expansion" can result in a combinatoric explosion if many arguments evaluate to union types. For example, if four arguments are present, and they all evaluate to unions that expand to ten subtypes, this could result in 10^4 combinations. Pyright expands unions for arguments left to right and halts expansion when the number of signatures exceeds 64.</p>
</li>
<li>
<p>If no overloads remain and all unions have been expanded, a diagnostic is generated indicating that the supplied arguments are incompatible with all overload signatures.</p>
</li>
</ol>
<h3 id="class-and-instance-variables">Class and Instance Variables</h3>
<p>Most object-oriented languages clearly differentiate between class variables and instance variables. Python is a bit looser in that it allows an object to overwrite a class variable with an instance variable of the same name.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="n">my_var</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="s2">&quot;hi!&quot;</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span> <span class="c1"># Class variable value of 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span> <span class="c1"># Class variable value of 0</span>

<span class="n">A</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span> <span class="c1"># Updated class variable value of 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span> <span class="c1"># Updated class variable value of 1</span>

<span class="n">a</span><span class="o">.</span><span class="n">my_method</span><span class="p">()</span> <span class="c1"># Writes to the instance variable my_var</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span> <span class="c1"># Class variable value of 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span> <span class="c1"># Instance variable value of &quot;hi!&quot;</span>

<span class="n">A</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span> <span class="c1"># Updated class variable value of 2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">my_var</span><span class="p">)</span> <span class="c1"># Instance variable value of &quot;hi!&quot;</span>
</code></pre></div>
<p>Pyright differentiates between three types of variables: pure class variables, regular class variables, and pure instance variables.</p>
<h4 id="pure-class-variables">Pure Class Variables</h4>
<p>If a class variable is declared with a <code>ClassVar</code> annotation as described in <a href="https://peps.python.org/pep-0526/#class-and-instance-variable-annotations">PEP 526</a>, it is considered a “pure class variable” and cannot be overwritten by an instance variable of the same name.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">ClassVar</span>

<span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">instance_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Type error: Cannot overwrite class variable</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">class_method</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

<span class="n">A</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Type error: Cannot overwrite class variable</span>
</code></pre></div>
<h4 id="regular-class-variables">Regular Class Variables</h4>
<p>If a class variable is declared without a <code>ClassVar</code> annotation, it can be overwritten by an instance variable of the same name. The declared type of the instance variable is assumed to be the same as the declared type of the class variable.</p>
<p>Regular class variables can also be declared within a class method using a <code>cls</code> member access expression, but declaring regular class variables within the class body is more common and generally preferred for readability.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="nf">instance_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">class_method</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">z</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">A</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">A</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0, 0, 0</span>

<span class="n">A</span><span class="o">.</span><span class="n">class_method</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0, 0, 3</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0, 0, 3</span>
<span class="n">a</span><span class="o">.</span><span class="n">instance_method</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 1, 2, 3</span>

<span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;hi!&quot;</span>  <span class="c1"># Error: Incompatible type</span>
</code></pre></div>
<h4 id="pure-instance-variables">Pure Instance Variables</h4>
<p>If a variable is not declared within the class body but is instead declared within a class method using a <code>self</code> member access expression, it is considered a “pure instance variable”. Such variables cannot be accessed through a class reference.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">:</span> <span class="nb">int</span>

<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Error: &#39;x&#39; is not a class variable</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

<span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 1, 2</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>  <span class="c1"># Error: &#39;z&#39; is not an known member</span>
</code></pre></div>
<h4 id="inheritance-of-class-and-instance-variables">Inheritance of Class and Instance Variables</h4>
<p>Class and instance variables are inherited from parent classes. If a parent class declares the type of a class or instance variable, a derived class must honor that type when assigning to it.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Parent</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Parent</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;hi!&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Error: Incompatible type</span>
</code></pre></div>
<p>The derived class can redeclare the type of a class or instance variable. If <code>reportIncompatibleVariableOverride</code> is enabled, the redeclared type must be the same as the type declared by the parent class. If the variable is immutable (as in a frozen <code>dataclass</code>), it is considered covariant, and it can be redeclared as a subtype of the type declared by the parent class.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Parent</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Parent</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Type error: &#39;x&#39; cannot be redeclared with subtype because variable is mutable and therefore invariant</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Type error: &#39;y&#39; cannot be redeclared with an incompatible type</span>
</code></pre></div>
<p>If a parent class declares the type of a class or instance variable and a derived class does not redeclare it but does assign a value to it, the declared type is retained from the parent class. It is not overridden by the inferred type of the assignment in the derived class.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Parent</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">object</span>

<span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Parent</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">reveal_type</span><span class="p">(</span><span class="n">Parent</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># object</span>
<span class="n">reveal_type</span><span class="p">(</span><span class="n">Child</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># object</span>
</code></pre></div>
<p>If neither the parent nor the derived class declare the type of a class or instance variable, the type is inferred within each class.</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Parent</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Child</span><span class="p">(</span><span class="n">Parent</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">reveal_type</span><span class="p">(</span><span class="n">Parent</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># object</span>
<span class="n">reveal_type</span><span class="p">(</span><span class="n">Child</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># int</span>
</code></pre></div>
<h4 id="type-variable-scoping">Type Variable Scoping</h4>
<p>A type variable must be bound to a valid scope (a class, function, or type alias) before it can be used within that scope.</p>
<p>Pyright displays the bound scope for a type variable using an <code>@</code> symbol. For example, <code>T@func</code> means that type variable <code>T</code> is bound to function <code>func</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">S</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">a</span> <span class="c1"># T refers to T@func</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="c1"># T@func</span>

    <span class="n">c</span><span class="p">:</span> <span class="n">S</span> <span class="c1"># Error: S has no bound scope in this context</span>
    <span class="k">return</span> <span class="n">b</span>
</code></pre></div>
<p>When a TypeVar or ParamSpec appears within parameter or return type annotations for a function and it is not already bound to an outer scope, it is normally bound to the function. As an exception to this rule, if the TypeVar or ParamSpec appears only within the return type annotation of the function and only within a single Callable in the return type, it is bound to that Callable rather than the function. This allows a function to return a generic Callable.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># T is bound to func1 because it appears in a parameter type annotation.</span>
<span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">T</span><span class="p">]:</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">T</span> <span class="c1"># OK because T is bound to func1</span>

<span class="c1"># T is bound to the return callable rather than func2 because it appears</span>
<span class="c1"># only within a return Callable.</span>
<span class="k">def</span> <span class="nf">func2</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">T</span><span class="p">]:</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">T</span> <span class="c1"># Error because T has no bound scope in this context</span>

<span class="c1"># T is bound to func3 because it appears outside of a Callable.</span>
<span class="k">def</span> <span class="nf">func3</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">T</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">:</span>
    <span class="o">...</span>

<span class="c1"># This scoping logic applies also to type aliases used within a return</span>
<span class="c1"># type annotation. T is bound to the return Callable rather than func4.</span>
<span class="n">Transform</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">],</span> <span class="n">S</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">func4</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Transform</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="o">...</span>
</code></pre></div>
<h3 id="type-annotation-comments">Type Annotation Comments</h3>
<p>Versions of Python prior to 3.6 did not support type annotations for variables. Pyright honors type annotations found within a comment at the end of the same line where a variable is assigned.</p>
<div class="highlight"><pre><span></span><code><span class="n">offsets</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># type: list[int]</span>

<span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># type: int | str</span>
</code></pre></div>
<p>Future versions of Python will likely deprecate support for type annotation comments. The “reportTypeCommentUsage” diagnostic will report usage of such comments so they can be replaced with inline type annotations.</p>
<h3 id="literal-math-inference">Literal Math Inference</h3>
<p>When inferring the type of some unary and binary operations that involve operands with literal types, pyright computes the result of operations on the literal values, producing a new literal type in the process. For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">y</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># Literal[5, 8, 7, 10]</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># Literal[4, 7, 12, 21]</span>

    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">|</span> <span class="n">y</span><span class="p">)</span> <span class="o">^</span> <span class="mi">1</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># Literal[4, 6]</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">**</span> <span class="n">y</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># Literal[1, 81, 2187]</span>
</code></pre></div>
<p>Literal math also works on <code>str</code> literals.</p>
<div class="highlight"><pre><span></span><code><span class="n">reveal_type</span><span class="p">(</span><span class="s2">&quot;a&quot;</span> <span class="o">+</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="c1"># Literal[&quot;ab&quot;]</span>
</code></pre></div>
<p>The result of a literal math operation can result in large unions. Pyright limits the number of subtypes in the resulting union to 64. If the union grows beyond that, the corresponding non-literal type is inferred.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="c1"># Literal[1, 2, 3, 4, 5, 6, 8, 10, 9, 12, 15, 16, 20, 25]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">x</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># int</span>
</code></pre></div>
<p>Literal math inference is disabled within loops and lambda expressions.</p>
<h3 id="static-conditional-evaluation">Static Conditional Evaluation</h3>
<p>Pyright performs static evaluation of several conditional expression forms. This includes several forms that are mandated by the <a href="https://typing.readthedocs.io/en/latest/spec/directives.html#version-and-platform-checking">Python typing spec</a>.</p>
<ul>
<li><code>sys.version_info &lt;comparison&gt; &lt;tuple&gt;</code></li>
<li><code>sys.version_info[0] &gt;= &lt;number&gt;</code></li>
<li><code>sys.platform == &lt;string literal&gt;</code></li>
<li><code>os.name == &lt;string literal&gt;</code></li>
<li><code>typing.TYPE_CHECKING</code> or <code>typing_extensions.TYPE_CHECKING</code></li>
<li><code>True</code> or <code>False</code></li>
<li>An identifier defined with the "defineConstant" configuration option</li>
<li>A <code>not</code> unary operator with any of the above forms</li>
<li>An  <code>and</code> or <code>or</code> binary operator with any of the above forms</li>
</ul>
<p>If one of these conditional expressions evaluates statically to false, pyright does not analyze any of the code within it other than checking for and reporting syntax errors.</p>
<h3 id="reachability">Reachability</h3>
<p>Pyright performs “reachability analysis” to determine whether statements will be executed at runtime.</p>
<p>Reachability analysis is based on both non-type and type information. Non-type information includes statements that unconditionally affect code flow such as <code>continue</code>, <code>raise</code> and <code>return</code>. It also includes conditional statements (<code>if</code>, <code>elif</code>, or <code>while</code>) where the conditional expression is one of these <a href="#static-conditional-evaluation">supported expression forms</a>. Type analysis is not performed on code determined to be unreachable using non-type information. Therefore, language server features like completion suggestions are not available for this code.</p>
<p>Here are some examples of code determined to be unreachable using non-type information.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unreachable&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unreachable&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unreachable&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;ENIAC&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unreachable&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func1</span><span class="p">():</span>
    <span class="k">return</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unreachable&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func2</span><span class="p">():</span>
    <span class="k">raise</span> <span class="bp">NotImplemented</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unreachable&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Pyright can also detect code that is unreachable based on static type analysis. This analysis is based on the assumption that any provided type annotations are accurate.</p>
<p>Here are some examples of code determined to be unreachable using type analysis.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">NoReturn</span>

<span class="k">def</span> <span class="nf">always_raise</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NoReturn</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span>

<span class="k">def</span> <span class="nf">func1</span><span class="p">():</span>
    <span class="n">always_raise</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unreachable&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unreachable&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func3</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unreachable&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Code that is determined to be unreachable is reported through the use of “tagged hints”. These are special diagnostics that tell a language client to display the code in a visually distinctive manner, typically with a grayed-out appearance. Code determined to be unreachable using non-type information is always reported through this mechanism. Code determined to be unreachable using type analysis is reported only if “enableReachabilityAnalysis” is enabled in the configuration.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/detachhead/basedpyright" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/basedpyright/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discord.gg/7y9upqPrk2" target="_blank" rel="noopener" title="discord.gg" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "content.code.copy", "navigation.top", "navigation.instant"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>